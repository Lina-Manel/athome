<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Islamic Red vs Blue Game (Session)</title>
<style>
  body { font-family: Arial; background:#f5f5f5; text-align:center; }
  h1 { margin-top:20px; }
  .screen { display:none; padding:20px; }
  .active { display:block; }
  .team-btn { padding:20px 40px; margin:20px; font-size:22px; border:none; color:white; border-radius:15px; cursor:pointer; }
  .red { background:#c62828; }
  .blue { background:#1565c0; }
  .section { background:white; padding:15px; margin:10px auto; width:80%; max-width:400px; border-radius:12px; cursor:pointer; box-shadow:0 2px 4px rgba(0,0,0,0.1);}
  .locked { background:#ddd; cursor:not-allowed; }
  #questionBox { background:white; padding:20px; width:85%; max-width:500px; margin:20px auto; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.2);}
  button { padding:12px 20px; margin-top:20px; font-size:18px; cursor:pointer;}
</style>
</head>
<body>

<h1>Red vs Blue Islamic Game</h1>

<!-- TEAM SELECTION -->
<div id="teamScreen" class="screen active">
  <h2>Choose your team</h2>
  <p id="teamStatus">Waiting for both teams to join...</p>
  <button class="team-btn red" onclick="joinTeam('red')">Red Team üî¥</button>
  <button class="team-btn blue" onclick="joinTeam('blue')">Blue Team üîµ</button>
</div>

<!-- SECTIONS SCREEN -->
<div id="sectionScreen" class="screen">
  <h2>Pick a Section</h2>
  <div id="sections"></div>
</div>

<!-- QUESTION SCREEN -->
<div id="questionScreen" class="screen">
  <div id="questionBox"></div>
</div>

<!-- SCORE SCREEN -->
<div id="scoreScreen" class="screen">
  <h2>Final Score</h2>
  <p id="scoreText"></p>
  <button onclick="resetGame()">Restart</button>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// ==== Firebase Config ====
const firebaseConfig = {
  apiKey: "AIzaSyAKP0ovl9ZERz9pHgdy-bNSD8GDtvDjmnc",
  authDomain: "athome-8dca5.firebaseapp.com",
  databaseURL: "https://athome-8dca5-default-rtdb.firebaseio.com",
  projectId: "athome-8dca5",
  storageBucket: "athome-8dca5.firebasestorage.app",
  messagingSenderId: "720555193634",
  appId: "1:720555193634:web:262b9a01b9dc3191cca17b",
  measurementId: "G-3V4N6Z7Z43"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ==== Game State ====
let gameState = {
  team: null,   // this device's team
  redScore:0,
  blueScore:0,
  lockedSections:{}
};

// ==== Sections and Questions ====
const sections = {
  "ÿßŸÑŸÜÿ∏ÿßŸÅÿ© ŸÅŸä ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖ":["ŸÑŸÖÿßÿ∞ÿß Ÿäÿπÿ™ÿ®ÿ± ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖ ÿßŸÑŸÜÿ∏ÿßŸÅÿ© ÿ¨ÿ≤ÿ°Ÿãÿß ŸÖŸÜ ÿßŸÑÿ•ŸäŸÖÿßŸÜÿü","ÿßÿ∞ŸÉÿ± ŸÖÿ´ÿßŸÑŸãÿß ŸÖŸÜ ÿßŸÑÿ≥ŸÜÿ© ŸäÿØŸÑ ÿπŸÑŸâ ÿ£ŸáŸÖŸäÿ© ÿßŸÑŸÜÿ∏ÿßŸÅÿ©."],
  "ÿßŸÑÿ™ÿ±ŸÅ ŸàÿßŸÑŸÖÿ∏ÿßŸáÿ± ÿßŸÑŸàÿ´ŸÜŸäÿ©":["ŸÖÿß ŸáŸà ŸÖŸàŸÇŸÅ ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖ ŸÖŸÜ ÿßŸÑŸÖÿ®ÿßŸÑÿ∫ÿ© ŸÅŸä ÿßŸÑÿ≤ŸäŸÜÿ©ÿü","ŸÑŸÖÿßÿ∞ÿß Ÿäÿ≠ÿ∞ÿ± ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖ ŸÖŸÜ ÿßŸÑÿ™ÿ¥ÿ®Ÿá ÿ®ÿßŸÑŸàÿ´ŸÜŸäŸäŸÜÿü"],
  "ÿ¢ŸÜŸäÿ© ÿßŸÑÿ∞Ÿáÿ® ŸàÿßŸÑŸÅÿ∂ÿ©":["ŸÖÿß ÿ≠ŸÉŸÖ ÿßŸÑÿ£ŸÉŸÑ ÿ£Ÿà ÿßŸÑÿ¥ÿ±ÿ® ŸÅŸä ÿ£ŸàÿßŸÜŸä ÿßŸÑÿ∞Ÿáÿ® ŸàÿßŸÑŸÅÿ∂ÿ©ÿü","ÿßÿ∞ŸÉÿ± ÿ≥ÿ®ÿ®Ÿãÿß ŸÖŸÜ ÿ£ÿ≥ÿ®ÿßÿ® ÿßŸÑÿ™ÿ≠ÿ±ŸäŸÖ."],
  "ÿ™ÿ¥ÿÆŸäÿµ Ÿàÿ™ŸÖÿßÿ´ŸäŸÑ":["ŸÖÿß ÿ≠ŸÉŸÖ ÿßŸÑÿ™ŸÖÿßÿ´ŸäŸÑ ÿßŸÑŸÖÿ¨ÿ≥ŸÖÿ© ŸÅŸä ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖÿü","ŸáŸÑ Ÿäÿ¨Ÿàÿ≤ Ÿàÿ∂ÿπ ÿßŸÑÿ™ŸÖÿßÿ´ŸäŸÑ ŸÑŸÑÿ≤ŸäŸÜÿ© ŸÅŸÇÿ∑ÿü ŸàŸÑŸÖÿßÿ∞ÿßÿü"],
  "ÿµŸàÿ± Ÿàÿ±ÿ≥ŸàŸÖÿßÿ™":["ŸÖÿß ÿßŸÑŸÅÿ±ŸÇ ÿ®ŸäŸÜ ÿßŸÑÿµŸàÿ± ÿßŸÑŸÅŸàÿ™Ÿàÿ∫ÿ±ÿßŸÅŸäÿ© ŸàÿßŸÑŸÖÿ±ÿ≥ŸàŸÖÿ©ÿü","ŸáŸÑ Ÿäÿ¨Ÿàÿ≤ ÿ™ÿπŸÑŸäŸÇ ÿßŸÑÿµŸàÿ± ÿπŸÑŸâ ÿßŸÑÿ¨ÿØÿ±ÿßŸÜÿü"],
  "ÿßŸÇÿ™ŸÜÿßÿ° ÿßŸÑŸÉŸÑÿßÿ®":["ŸÖÿß ÿ≠ŸÉŸÖ ÿßŸÇÿ™ŸÜÿßÿ° ÿßŸÑŸÉŸÑÿßÿ® ÿ®ÿØŸàŸÜ ÿ≠ÿßÿ¨ÿ©ÿü","ÿßÿ∞ŸÉÿ± ÿßŸÑÿ≠ÿßŸÑÿßÿ™ ÿßŸÑÿ™Ÿä Ÿäÿ¨Ÿàÿ≤ ŸÅŸäŸáÿß ÿßŸÇÿ™ŸÜÿßÿ° ÿßŸÑŸÉŸÑÿßÿ®."]
};

// ==== Team Joining ====
function joinTeam(team){
  gameState.team = team;
  db.ref('game/team/'+team+'/joined').set(true);
  showScreen('sectionScreen');
  loadSections();
}

// ==== Listen for section changes ====
db.ref('game/lockedSections').on('value', snapshot=>{
  gameState.lockedSections = snapshot.val() || {};
  loadSections();
});

// ==== Load Sections ====
function loadSections(){
  const container=document.getElementById('sections');
  container.innerHTML='';
  Object.keys(sections).forEach(sec=>{
    const div=document.createElement('div');
    div.className='section';
    if(gameState.lockedSections[sec]){
      div.classList.add('locked');
      div.innerHTML=`${sec} ‚ùå (Taken by ${gameState.lockedSections[sec]})`;
    } else {
      div.innerHTML=sec;
      div.onclick=()=>pickSection(sec);
    }
    container.appendChild(div);
  });
}

// ==== Pick Section ====
function pickSection(section){
  if(gameState.lockedSections[section]) return;
  db.ref('game/lockedSections/'+section).set(gameState.team);
  const qList=sections[section];
  const q=qList[Math.floor(Math.random()*qList.length)];
  showQuestion(q);
}

// ==== Show Question ====
function showQuestion(q){
  showScreen('questionScreen');
  const box=document.getElementById('questionBox');
  box.innerHTML=`
    <h3>Question for ${gameState.team==='red'?'Red Team üî¥':'Blue Team üîµ'}</h3>
    <p>${q}</p>
    <button onclick="answer(true)">Correct ‚úîÔ∏è</button>
    <button onclick="answer(false)">Wrong ‚ùå</button>
  `;
}

// ==== Answer Handling ====
function answer(isCorrect){
  if(isCorrect){
    if(gameState.team==='red') db.ref('game/redScore').transaction(s=> (s||0)+1 );
    else db.ref('game/blueScore').transaction(s=> (s||0)+1 );
  }
  showScreen('sectionScreen');
  loadSections();
}

// ==== Listen for scores ====
db.ref('game').on('value', snapshot=>{
  const data = snapshot.val() || {};
  gameState.redScore = data.redScore || 0;
  gameState.blueScore = data.blueScore || 0;
  // Check if game finished
  if(Object.keys(gameState.lockedSections).length === Object.keys(sections).length){
    showScore();
  }
});

// ==== Show Score ====
function showScore(){
  showScreen('scoreScreen');
  document.getElementById('scoreText').innerHTML=`
    üî¥ Red Team: ${gameState.redScore}<br>
    üîµ Blue Team: ${gameState.blueScore}<br><br>
    <strong>Winner: ${gameState.redScore>gameState.blueScore?'Red Team üî¥':gameState.redScore<gameState.blueScore?'Blue Team üîµ':'Tie ü§ù'}</strong>
  `;
}

// ==== Reset Game ====
function resetGame(){
  db.ref('game').remove();
  window.location.reload();
}

// ==== Show Screen ====
function showScreen(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}
</script>
</body>
</html>
