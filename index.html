<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Red vs Blue Islamic Game</title>
<style>
  body { font-family: 'Segoe UI', Tahoma, sans-serif; background:#f0f4f8; text-align:center; margin:0; }
  h1 { margin-top:20px; color:#333; }
  .screen { display:none; padding:20px; transition: all 0.3s ease; }
  .active { display:block; }
  .team-btn { padding:20px 50px; margin:20px; font-size:22px; border:none; color:white; border-radius:15px; cursor:pointer; box-shadow:0 5px 15px rgba(0,0,0,0.2); transition:0.3s; }
  .team-btn:hover { transform: translateY(-3px); }
  .team-btn:disabled { opacity:0.5; cursor:not-allowed; }
  .section { background:white; padding:20px; margin:15px auto; width:80%; max-width:450px; border-radius:15px; cursor:pointer; box-shadow:0 4px 10px rgba(0,0,0,0.15); transition:0.2s; }
  .section:hover { transform: translateY(-2px); box-shadow:0 6px 12px rgba(0,0,0,0.2); }
  .locked { background:#ddd; cursor:not-allowed; }
  #questionBox { background:white; padding:25px; width:85%; max-width:500px; margin:20px auto; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.2); }
  #questionBox button { padding:12px 25px; margin:10px; font-size:18px; cursor:pointer; border:none; border-radius:10px; transition:0.2s; background:#2196f3; color:white; }
  #questionBox button:hover { transform: scale(1.05); }
  #scoreScreen button { padding:15px 30px; font-size:20px; background:#ff9800; color:white; border:none; border-radius:12px; cursor:pointer; transition:0.2s; }
  #scoreScreen button:hover { transform: translateY(-3px); }
  .current-score { position: fixed; top: 10px; right: 10px; background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
  .waiting { color: #666; font-style: italic; }
  #timer { position: fixed; top: 10px; left: 10px; background:white; padding: 12px 18px; border-radius:10px; font-size:18px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
</style>
</head>
<body>

<h1>Red vs Blue Islamic Game</h1>

<div id="timer">‚è±Ô∏è 30:00</div>

<div class="current-score" id="liveScore" style="display:none;">
  <div>üî¥ Red: <span id="redScoreLive">0</span></div>
  <div>üîµ Blue: <span id="blueScoreLive">0</span></div>
</div>

<!-- TEAM SELECTION -->
<div id="teamScreen" class="screen active">
  <h2>Choose your team</h2>
  <p id="teamStatus">Waiting for both teams to join...</p>
  <button class="team-btn red" id="redBtn" onclick="joinTeam('red')">Red Team üî¥</button>
  <button class="team-btn blue" id="blueBtn" onclick="joinTeam('blue')">Blue Team üîµ</button>
  <p class="waiting" id="waitingMsg" style="display:none;">Waiting for other team...</p>
</div>

<!-- SECTION SELECTION -->
<div id="sectionScreen" class="screen">
  <h2 id="sectionTitle">Pick a Section</h2>
  <div id="sections"></div>
</div>

<!-- QUESTION SCREEN -->
<div id="questionScreen" class="screen">
  <div id="questionBox"></div>
</div>

<!-- SCORE SCREEN -->
<div id="scoreScreen" class="screen">
  <h2>Final Score</h2>
  <p id="scoreText"></p>
  <button onclick="resetGame()">Restart Game</button>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
/* ========== FIREBASE CONFIG ========== */
const firebaseConfig = {
  apiKey: "AIzaSyAKP0ovl9ZERz9pHgdy-bNSD8GDtvDjmnc",
  authDomain: "athome-8dca5.firebaseapp.com",
  databaseURL: "https://athome-8dca5-default-rtdb.firebaseio.com",
  projectId: "athome-8dca5",
  storageBucket: "athome-8dca5.firebasestorage.app",
  messagingSenderId: "720555193634",
  appId: "1:720555193634:web:262b9a01b9dc3191cca17b"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* ========== GAME STATE ========== */
let gameState = {
  team: null,
  currentSection: null,
  currentQuestionIndex: 0,
  currentQuestions: [],
  lockedSections: {},
  timeUp: false
};

/* ========== PLAYER ID ========== */
const myID = "u_" + Math.random().toString(36).substr(2,9);
db.ref("game/players/"+myID).set(true);
db.ref("game/players/"+myID).onDisconnect().remove();


/* ========== SECTIONS + QUESTIONS ========== */
const sections = {
  "ÿßŸÑŸÜÿ∏ÿßŸÅÿ© ŸàÿßŸÑÿ¨ŸÖÿßŸÑ ŸÅŸä ÿßŸÑÿ®Ÿäÿ™": [
    { type:"tf", q:"ŸÉÿßŸÜ ÿßŸÑŸÜÿ®Ÿä Ô∑∫ Ÿäÿ≠ÿ® ÿßÿ™ÿ≥ÿßÿπ ÿßŸÑÿØÿßÿ± ŸàŸäÿ≠ÿ´ ÿπŸÑŸâ ŸÜÿ∏ÿßŸÅÿ© ÿßŸÑÿ®Ÿäÿ™ ŸÑÿ£ŸÜŸáÿß ŸÖŸÜ ŸÖÿ∏ÿßŸáÿ± ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖ.", a:true },
    { type:"mcq", q:"ŸÖÿß ÿßŸÑŸÖŸÇÿµŸàÿØ ÿ®ÿ¨Ÿàÿßÿ≤ ÿ™ÿ¨ŸÖŸäŸÑ ÿßŸÑÿ®Ÿäÿ™ ÿ®ÿßŸÑÿ≤ŸäŸÜÿ© ÿßŸÑÿ≠ŸÑÿßŸÑÿü", a:"B", options:["A. ÿ£ŸÜŸá Ÿàÿßÿ¨ÿ® ÿπŸÑŸâ ŸÉŸÑ ŸÖÿ≥ŸÑŸÖ","B. ÿ£ŸÜŸá ŸÖÿ®ÿßÿ≠ ŸÖÿß ÿØÿßŸÖ ÿ®ŸÑÿß ÿ•ÿ≥ÿ±ÿßŸÅ ÿ£Ÿà ÿ™ÿ¥ÿ®Ÿá ŸÖÿ≠ÿ±ŸÖ","C. ÿ£ŸÜŸá ŸÖŸÉÿ±ŸàŸá ŸÑÿ£ŸÜŸá ÿ™ÿ±ŸÅ","D. ÿ£ŸÜŸá ÿÆÿßÿµ ÿ®ÿßŸÑŸÜÿ≥ÿßÿ° ŸÅŸÇÿ∑"] },
    { type:"mcq", q:"ŸÖÿß ÿßŸÑÿ≠ŸÉŸÖÿ© ŸÖŸÜ ŸÖŸÜÿπ ÿßŸÑÿ™ŸÉŸÑŸÅ ŸÅŸä ÿßŸÑÿ≤ŸäŸÜÿ© ÿßŸÑŸÖÿ®ÿßŸÑÿ∫ ŸÅŸäŸáÿß ÿØÿßÿÆŸÑ ÿßŸÑÿ®ŸäŸàÿ™ÿü", a:"B", options:["A. ŸÑÿ£ŸÜŸáÿß ÿ™ÿ¥ÿ∫ŸÑ ÿπŸÜ ÿßŸÑÿπÿ®ÿßÿØÿ© ŸÅŸÇÿ∑","B. ŸÑÿ£ŸÜŸáÿß ŸÇÿØ ÿ™ÿ§ÿØŸä ŸÑŸÑÿ±Ÿäÿßÿ°ÿå ŸàÿßŸÑÿ•ÿ≥ÿ±ÿßŸÅÿå ŸàŸÖÿÆÿßŸÑŸÅÿ© ÿßŸÑÿßÿπÿ™ÿØÿßŸÑ ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖŸä","C. ŸÑÿ£ŸÜŸáÿß ŸÖÿØÿπÿßÿ© ŸÑŸÑÿÆÿµÿßŸÖ ÿ®ŸäŸÜ ÿßŸÑŸÜÿßÿ≥","D. ŸÑÿ£ŸÜŸáÿß ÿ™Ÿèÿ¥ÿ®Ÿá ÿ®ŸäŸàÿ™ ÿßŸÑŸÖÿ¥ÿ±ŸÉŸäŸÜ"] }
  ],
  "ÿ¢ŸÜŸäÿ© ÿßŸÑÿ∞Ÿáÿ® ŸàÿßŸÑŸÅÿ∂ÿ©": [
    { type:"tf", q:"ÿ™ÿ≠ÿ±ŸäŸÖ ÿ£ŸàÿßŸÜŸä ÿßŸÑÿ∞Ÿáÿ® ŸàÿßŸÑŸÅÿ∂ÿ© Ÿäÿ¥ŸÖŸÑ ÿßŸÑÿ±ÿ¨ÿßŸÑ ŸÅŸÇÿ∑ ÿØŸàŸÜ ÿßŸÑŸÜÿ≥ÿßÿ°.", a:false },
    { type:"mcq", q:"ŸÖŸÜ ÿ£ÿ≥ÿ®ÿßÿ® ŸÖŸÜÿπ ÿßÿ≥ÿ™ÿπŸÖÿßŸÑ ÿ¢ŸÜŸäÿ© ÿßŸÑÿ∞Ÿáÿ® ŸàÿßŸÑŸÅÿ∂ÿ© ŸÅŸä ÿßŸÑÿ£ŸÉŸÑ ŸàÿßŸÑÿ¥ÿ±ÿ®:", a:"C", options:["A. ŸÑÿ£ŸÜŸáÿß ÿ∞ÿßÿ™ ŸÑŸàŸÜ ŸÑÿßŸÖÿπ","B. ŸÑÿ£ŸÜŸáÿß ŸÉÿßŸÜÿ™ ÿ™ÿ≥ÿ™ÿπŸÖŸÑ ŸÅŸÇÿ∑ ÿπŸÜÿØ ÿßŸÑÿ±ŸàŸÖÿßŸÜ","C. ŸÑÿ£ŸÜŸáÿß ÿµŸàÿ±ÿ© ŸÖŸÜ ÿµŸàÿ± ÿßŸÑÿ™ÿ±ŸÅ ŸàÿßŸÑÿ•ÿ≥ÿ±ÿßŸÅ ŸàŸÉÿ≥ÿ± ŸÇŸÑŸàÿ® ÿßŸÑŸÅŸÇÿ±ÿßÿ°","D. ŸÑÿ£ŸÜŸáÿß ÿ´ŸÇŸäŸÑÿ© ÿßŸÑŸàÿ≤ŸÜ"] },
    { type:"mcq", q:"ŸÑŸÖÿßÿ∞ÿß ŸÑŸÖ ÿ™Ÿèÿ≠ÿ±ŸëŸÖ ÿ£ŸàÿßŸÜŸä ÿßŸÑŸäÿßŸÇŸàÿ™ ŸàÿßŸÑÿ£ÿ≠ÿ¨ÿßÿ± ÿßŸÑÿ´ŸÖŸäŸÜÿ© ÿ±ÿ∫ŸÖ ÿ£ŸÜŸáÿß ÿ£ÿ∫ŸÑŸâ ŸÖŸÜ ÿßŸÑÿ∞Ÿáÿ® ŸàÿßŸÑŸÅÿ∂ÿ©ÿü", a:"D", options:["A. ŸÑÿ£ŸÜŸáÿß ŸÑŸäÿ≥ÿ™ ÿ¨ŸÖŸäŸÑÿ©","B. ŸÑÿ£ŸÜ ÿßŸÑŸÅŸÇÿ±ÿßÿ° ŸÑÿß Ÿäÿπÿ±ŸÅŸàŸÜŸáÿß ŸÅŸÑÿß ÿ™ÿ™ÿ£ÿ∞Ÿâ ŸÇŸÑŸàÿ®ŸáŸÖ","C. ŸÑÿ£ŸÜŸáÿß ŸÉÿßŸÜÿ™ ŸÜÿßÿØÿ±ÿ© ŸÅŸÑÿß ŸäÿµŸÜÿπ ŸÖŸÜŸáÿß ÿ£ŸàÿßŸÜŸç ÿ∫ÿßŸÑÿ®ÿßŸã","D. ÿßŸÑÿ¨Ÿàÿßÿ®ÿßŸÜ B Ÿà C ŸÖÿπÿß"] }
  ],
  "ÿßŸÑÿ™ŸÖÿßÿ´ŸäŸÑ": [
    { type:"tf", q:"Ÿàÿ¨ŸàÿØ ÿßŸÑÿ™ŸÖÿßÿ´ŸäŸÑ ŸÅŸä ÿßŸÑÿ®Ÿäÿ™ ÿ≥ÿ®ÿ® ŸÑÿ™ŸÜŸÅŸäÿ± ÿßŸÑŸÖŸÑÿßÿ¶ŸÉÿ©.", a:true },
    { type:"mcq", q:"ŸÖÿß ÿßŸÑÿÆÿ∑ÿ± ÿßŸÑŸÖÿ±ÿ™ÿ®ÿ∑ ÿ®ÿßŸÑÿ™ŸÖÿßÿ´ŸäŸÑ ŸàÿßŸÑÿ∞Ÿä ÿ¨ÿπŸÑ ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖ Ÿäÿ¥ÿØÿØ ŸÅŸä ÿ≠ŸÉŸÖŸáÿßÿü", a:"B", options:["A. ŸÑÿ£ŸÜŸáÿß ÿ®ÿßŸáÿ∏ÿ© ÿßŸÑÿ´ŸÖŸÜ","B. ŸÑÿ£ŸÜŸáÿß ŸÇÿØ ÿ™Ÿèÿπÿ∏ŸëŸÖ ŸÅÿ™ÿ§ÿØŸä ÿ•ŸÑŸâ ÿßŸÑÿ¥ÿ±ŸÉ ŸÉŸÖÿß ŸàŸÇÿπ ŸÅŸä ÿßŸÑÿ£ŸÖŸÖ ÿßŸÑÿ≥ÿßÿ®ŸÇÿ©","C. ŸÑÿ£ŸÜŸáÿß ÿ™ÿ¥ÿ∫ŸÑ ŸÖÿ≥ÿßÿ≠ÿ© ŸÅŸä ÿßŸÑŸÖŸÜÿ≤ŸÑ","D. ŸÑÿ£ŸÜŸáÿß ÿ´ŸÇŸäŸÑÿ© ÿßŸÑÿ≠ŸÖŸÑ"] },
    { type:"mcq", q:"ŸÖÿß ÿßŸÑÿπŸÑÿ© ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ© ÿßŸÑÿ™Ÿä ÿ®ŸèŸÜŸä ÿπŸÑŸäŸáÿß ÿ™ÿ≠ÿ±ŸäŸÖ ÿßŸÑÿ™ŸÖÿßÿ´ŸäŸÑÿü", a:"A", options:["A. ÿ≠ŸÖÿßŸäÿ© ÿßŸÑÿ™Ÿàÿ≠ŸäÿØ Ÿàÿ≥ÿØ ÿßŸÑÿ∞ÿ±ÿßÿ¶ÿπ ÿ•ŸÑŸâ ÿ™ÿπÿ∏ŸäŸÖ ÿßŸÑÿ£ÿ¥ÿÆÿßÿµ","B. ŸÑÿ£ŸÜŸáÿß ÿ™ŸèŸÅÿ≥ÿØ ÿßŸÑÿ∞ŸàŸÇ ÿßŸÑÿπÿßŸÖ","C. ŸÑÿ£ŸÜŸáÿß ŸÉÿßŸÜÿ™ ÿ™ŸèÿµŸÜÿπ ŸÖŸÜ ÿßŸÑÿ≠ÿ¨ÿßÿ±ÿ© ŸÅŸÇÿ∑","D. ŸÑÿ£ŸÜŸáÿß ÿ™Ÿèÿ≥ÿ®ÿ® ŸÜÿ≤ÿßÿπÿßÿ™ ÿ®ŸäŸÜ ÿßŸÑŸÜÿßÿ≥"] }
  ],
  "ÿ£ŸÑÿπÿßÿ® ÿßŸÑÿ£ÿ∑ŸÅÿßŸÑ (ÿßŸÑÿØŸÖŸâ)": [
    { type:"tf", q:"ÿ£ÿ®Ÿäÿ≠ÿ™ ÿØŸÖŸâ ÿßŸÑÿ£ÿ∑ŸÅÿßŸÑ ŸÑÿ£ŸÜŸáÿß ÿ™Ÿèÿπÿ™ÿ®ÿ± ŸÖŸÖÿ™ŸáŸÜÿ© ŸàŸÑÿß ŸäŸèŸÇÿµÿØ ÿ®Ÿáÿß ÿßŸÑÿ™ÿπÿ∏ŸäŸÖ.", a:true },
    { type:"mcq", q:"ŸÖÿß ÿßŸÑÿ≥ÿ®ÿ® ŸÅŸä ÿ™ÿÆÿµŸäÿµ ÿßŸÑÿ±ÿÆÿµÿ© ŸÑŸÑÿ£ÿ∑ŸÅÿßŸÑ ÿØŸàŸÜ ÿßŸÑŸÉÿ®ÿßÿ±ÿü", a:"B", options:["A. ŸÑÿ£ŸÜ ÿßŸÑÿ∑ŸÅŸÑ ŸÑÿß Ÿäÿπÿ±ŸÅ ŸÇŸäŸÖÿ© ÿßŸÑÿ£ÿ¥Ÿäÿßÿ°","B. ŸÑÿ£ŸÜ ŸÑÿπÿ® ÿßŸÑÿ£ÿ∑ŸÅÿßŸÑ ŸÑÿß ÿ™Ÿèÿ®ŸÇŸä ŸáŸäÿ¶ÿ© ÿßŸÑÿ™ŸÖÿ´ÿßŸÑ ŸÖÿ≠ÿ™ÿ±ŸÖÿ©","C. ŸÑÿ£ŸÜ ÿßŸÑÿ£ÿ∑ŸÅÿßŸÑ Ÿäÿ≠ÿ®ŸàŸÜ ÿßŸÑŸÑÿπÿ®","D. ŸÑÿ£ŸÜ ÿßŸÑŸÉÿ®ÿßÿ± ŸÑÿß Ÿäÿ≠ÿ™ÿßÿ¨ŸàŸÜ ÿ£ŸÑÿπÿßÿ®ÿßŸã"] },
   { type:"mcq", q:"ŸÖÿß ÿßŸÑŸÅÿ±ŸÇ ÿ®ŸäŸÜ ŸÑÿπÿ® ÿßŸÑÿ£ÿ∑ŸÅÿßŸÑ ŸàÿßŸÑÿ™ŸÖÿßÿ´ŸäŸÑ ÿßŸÑŸÖÿ≠ÿ±ŸÖÿ©ÿü", a:"B", options:["A. ÿ£ŸÜ ŸÑÿπÿ® ÿßŸÑÿ£ÿ∑ŸÅÿßŸÑ ÿ®ŸÑÿß ŸÖŸÑÿßŸÖÿ≠","B. ÿ£ŸÜ ŸÑÿπÿ® ÿßŸÑÿ£ÿ∑ŸÅÿßŸÑ ŸÖŸÖÿ™ŸáŸÜÿ© ŸÑÿß ÿ™Ÿèÿπÿ∏ŸëŸÖ","C. ÿ£ŸÜŸáÿß ŸÖÿµŸÜŸàÿπÿ© ŸÖŸÜ ÿßŸÑŸÇÿ∑ŸÜ ŸÅŸÇÿ∑","D. ÿ£ŸÜŸáÿß ŸÖŸàÿ¨ŸàÿØÿ© ŸÅŸä ŸÉŸÑ ÿßŸÑÿ®ŸäŸàÿ™"] }
   ],
  "ÿßŸÑÿ™ŸÖÿßÿ´ŸäŸÑ ÿßŸÑŸÉÿ®Ÿäÿ±ÿ© (ÿßŸÑŸÜÿµŸÅŸäÿ© / ŸÅŸä ÿßŸÑŸÖŸäÿßÿØŸäŸÜ)": [
    { type:"tf", q:"ÿßŸÑÿ™ŸÖÿßÿ´ŸäŸÑ ÿßŸÑŸÜÿµŸÅŸäÿ© ÿßŸÑÿ™Ÿä ÿ™ŸèŸÜÿµÿ® ŸÅŸä ÿßŸÑÿ≥ÿßÿ≠ÿßÿ™ ÿßŸÑÿπÿßŸÖÿ© ÿ™ÿπÿ™ÿ®ÿ± ÿ£ÿÆŸÅŸë ÿ≠ÿ±ŸÖÿ© ŸÖŸÜ ÿßŸÑÿ™ŸÖÿßÿ´ŸäŸÑ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© ŸÅŸä ÿßŸÑÿ®ŸäŸàÿ™.", a:false },
    { type:"mcq", q:"ŸÑŸÖÿßÿ∞ÿß ÿßÿπÿ™Ÿèÿ®ÿ±ÿ™ ÿßŸÑÿ™ŸÖÿßÿ´ŸäŸÑ ÿßŸÑŸÜÿµŸÅŸäÿ© ŸÅŸä ÿßŸÑŸÖŸäÿßÿØŸäŸÜ ÿ£ÿ¥ÿØ ŸÖŸÜÿπÿßŸãÿü", a:"B", options:["A. ŸÑÿ£ŸÜŸáÿß ÿ£ŸÉÿ®ÿ± ÿ≠ÿ¨ŸÖÿßŸã","B. ŸÑÿ£ŸÜŸáÿß ÿ™ŸèŸÇÿßŸÖ ŸÑŸÑÿ™ÿÆŸÑŸäÿØ ŸàÿßŸÑÿ™ÿπÿ∏ŸäŸÖ ÿßŸÑÿπŸÑŸÜŸä ŸÑŸÑÿ¥ÿÆÿµ","C. ŸÑÿ£ŸÜŸáÿß ÿ®ÿßŸáÿ∏ÿ© ÿßŸÑÿ™ŸÉŸÑŸÅÿ©","D. ŸÑÿ£ŸÜŸáÿß ŸÇÿØ ÿ™ŸèŸÅÿ≥ÿØ ÿßŸÑŸÖŸÜÿ∏ÿ±"] },
    { type:"mcq", q:"ŸÖÿß ÿßŸÑÿπŸÑÿ© ÿßŸÑÿ™Ÿä ÿ™ÿ¨ÿπŸÑ ÿ•ŸÇÿßŸÖÿ© ÿ™ŸÖÿßÿ´ŸäŸÑ ÿßŸÑÿπÿ∏ŸÖÿßÿ° ŸÅŸä ÿßŸÑŸÖŸäÿßÿØŸäŸÜ ŸÖÿ¥ŸÉŸÑÿ© ŸÅŸä ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖÿü", a:"B", options:["A. ŸÑÿ£ŸÜŸáÿß ÿ™Ÿèÿ¥ÿ®Ÿá ÿπÿßÿØÿ© ÿßŸÑŸÖŸÑŸàŸÉ ŸÅŸÇÿ∑","B. ŸÑÿ£ŸÜŸáÿß Ÿàÿ≥ŸäŸÑÿ© ŸÑŸÑÿ∫ŸÑŸà ŸÅŸä ÿßŸÑÿ£ÿ¥ÿÆÿßÿµ ŸÖŸÖÿß ŸÇÿØ Ÿäÿ¨ÿ±Ÿë ÿ•ŸÑŸâ ÿ™ÿπÿ∏ŸäŸÖŸáŸÖ ŸàŸÖÿ≠ÿ®ÿ™ŸáŸÖ ŸÅŸàŸÇ ÿßŸÑŸÇÿØÿ± ÿßŸÑÿ¥ÿ±ÿπŸä","C. ŸÑÿ£ŸÜŸáÿß ÿ™Ÿèÿ¥ÿ∫ŸÑ ŸÖŸÉÿßŸÜÿßŸã ŸÉÿ®Ÿäÿ±ÿßŸã","D. ŸÑÿ£ŸÜŸáÿß ÿ∫Ÿäÿ± ÿ¨ŸäÿØÿ© ÿßŸÑÿµŸÜÿπ"] }
  ],
  "ÿ£ÿ≠ŸÉÿßŸÖ ÿßŸÑÿµŸàÿ± ŸàÿßŸÑŸÖÿµŸàŸëÿ±ŸäŸÜ": [
    { type:"tf", q:"ŸÖŸÜ ŸÇÿµÿØ ŸÖÿ∂ÿßŸáÿßÿ© ÿÆŸÑŸÇ ÿßŸÑŸÑŸá ŸÅŸä ÿµŸàÿ±Ÿá ŸÉÿßŸÜ ŸÅÿπŸÑŸá ŸÉŸÅÿ±Ÿãÿß ÿ®Ÿàÿßÿ≠Ÿãÿß.", a:true },
    { type:"mcq", q:"ŸÖÿ™Ÿâ ŸäŸÉŸàŸÜ ÿ™ÿµŸàŸäÿ± ÿ∞Ÿàÿßÿ™ ÿßŸÑÿ£ÿ±Ÿàÿßÿ≠ ŸÉŸÅÿ±Ÿãÿßÿü", a:"B", options:["A. ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿßŸÑÿµŸàÿ±ÿ© ÿ¨ŸÖŸäŸÑÿ©","B. ÿ•ÿ∞ÿß ÿßÿØŸëÿπŸâ ÿßŸÑŸÖÿµŸàŸëŸêÿ± ÿ£ŸÜŸá ŸÇÿßÿØÿ± ÿπŸÑŸâ ÿÆŸÑŸÇ ŸÖÿ´ŸÑ ÿÆŸÑŸÇ ÿßŸÑŸÑŸá","C. ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿ®ÿ£ŸÑŸàÿßŸÜ ÿ≤ÿßŸáŸäÿ©","D. ÿ•ÿ∞ÿß ŸàŸèÿ∂ÿπÿ™ ÿπŸÑŸâ ÿßŸÑÿ≠ÿßÿ¶ÿ∑"] },
    { type:"mcq", q:"ŸÑŸÖÿßÿ∞ÿß ŸäŸÉŸàŸÜ ÿßÿØÿπÿßÿ° ÿßŸÑŸÖÿ∂ÿßŸáÿßÿ© ŸÉŸÅÿ±Ÿãÿßÿü", a:"B", options:["A. ŸÑÿ£ŸÜŸá ÿ•ÿ≥ÿ±ÿßŸÅ","B. ŸÑÿ£ŸÜŸá ÿßÿØŸëÿπÿßÿ° ŸÑÿÆÿßÿµŸäÿ© ŸÖŸÜ ÿÆÿµÿßÿ¶ÿµ ÿßŸÑÿ±ÿ®Ÿàÿ®Ÿäÿ©","C. ŸÑÿ£ŸÜŸá ÿ™ÿ¥ÿ®ŸëŸá ÿ®ÿ∫Ÿäÿ± ÿßŸÑŸÖÿ≥ŸÑŸÖŸäŸÜ","D. ŸÑÿ£ŸÜŸá ŸÅŸÜ ÿ∫Ÿäÿ± ŸÖÿ≠ÿ™ÿ±ŸÖ"] }
  ],
 
  "ÿ™ÿπÿ∏ŸäŸÖ ÿßŸÑÿµŸàÿ± ÿ∫Ÿäÿ± ÿßŸÑŸÖÿ¨ÿ≥ŸÖÿ©": [
    { type:"tf", q:"ÿ™ÿπÿ∏ŸäŸÖ ÿßŸÑÿµŸàÿ± ÿ∫Ÿäÿ± ÿßŸÑŸÖÿ¨ÿ≥ŸÖÿ© ŸÑŸÑÿ≠ŸÉÿßŸÖ ÿßŸÑÿ∏ÿßŸÑŸÖŸäŸÜ ŸÖÿ≠ÿ±ŸÖ.", a:true },
    { type:"mcq", q:"ŸÖÿß ÿßŸÑÿ≠ŸÉŸÖ ŸÅŸä ÿ™ÿπŸÑŸäŸÇ ÿµŸàÿ± ÿßŸÑÿ≤ÿπŸÖÿßÿ° ÿπŸÑŸâ ÿßŸÑÿ¨ÿØÿ±ÿßŸÜÿü", a:"B", options:["A. ÿ¨ÿßÿ¶ÿ≤ ŸÖÿ∑ŸÑŸÇŸãÿß","B. ŸÖÿ≠ÿ±ŸëŸÖ ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸÅŸäŸá ÿ™ÿπÿ∏ŸäŸÖ","C. ŸÖŸÉÿ±ŸàŸá ŸÅŸÇÿ∑","D. ŸÑÿß ÿπŸÑÿßŸÇÿ© ŸÑŸá ÿ®ÿßŸÑÿØŸäŸÜ"] },
    { type:"mcq", q:"ŸÖÿß ÿßŸÑÿ≥ÿ®ÿ® ÿßŸÑÿ£ÿ¥ÿØ ŸÅŸä ÿ™ÿ≠ÿ±ŸäŸÖ ÿßŸÑÿµŸàÿ± ÿ∫Ÿäÿ± ÿßŸÑŸÖÿ¨ÿ≥ŸÖÿ© ŸÑŸÑŸÅÿ≥ŸëÿßŸÇ ŸàÿßŸÑÿ∏ŸÑŸÖÿ©ÿü", a:"B", options:["A. ŸÑÿ£ŸÜŸáÿß ŸÖŸÑŸàŸÜÿ©","B. ŸÑÿ£ŸÜŸáÿß ÿ™ÿ§ÿØŸä ŸÑÿ™ÿπÿ∏ŸäŸÖ ÿ£ŸáŸÑ ÿßŸÑŸÅÿ≥ŸÇ","C. ŸÑÿ£ŸÜŸáÿßÿ™Ÿèÿ¥ÿ®Ÿá ÿµŸàÿ± ÿßŸÑŸÅŸÜ","D. ŸÑÿ£ŸÜŸáÿß ÿ™ÿπŸÑŸÇ ŸÅŸä ÿ∫ÿ±ŸÅ ŸÉÿ®Ÿäÿ±ÿ©"] }

],
  "ÿßŸÑÿµŸàÿ± ÿ∫Ÿäÿ± ÿßŸÑŸÖÿ¨ÿ≥ŸÖÿ© ŸÑŸÑÿ≤ŸäŸÜÿ©": [
    { type:"tf", q:"ÿßŸÑÿµŸàÿ± ÿßŸÑŸÖÿ≥ÿ∑ÿ≠ÿ© ŸÑÿ∞Ÿàÿßÿ™ ÿßŸÑÿ£ÿ±Ÿàÿßÿ≠ ÿ•ÿ∞ÿß ŸàŸèÿ∂ÿπÿ™ ŸÑŸÑÿ≤ŸäŸÜÿ© ŸÅŸáŸä ŸÖŸÜŸáŸä ÿπŸÜŸáÿß.", a:true },
    { type:"mcq", q:"ŸÖÿß ÿ≥ÿ®ÿ® ŸÉÿ±ÿßŸáÿ© Ÿàÿ∂ÿπ ÿßŸÑÿµŸàÿ± ÿπŸÑŸâ ÿßŸÑÿ¨ÿØÿ±ÿßŸÜ ŸÑŸÑÿ≤ŸäŸÜÿ©ÿü", a:"B", options:["A. ŸÑÿ£ŸÜŸáÿß ÿ™ÿ≥ÿ™ŸáŸÑŸÉ ÿßŸÑŸÉŸáÿ±ÿ®ÿßÿ°","B. ŸÑÿ£ŸÜŸáÿß ŸÖŸÜ ÿßŸÑÿ™ÿ±ŸÅ ÿßŸÑÿ≤ÿßÿ¶ÿØ","C. ŸÑÿ£ŸÜŸáÿß ŸÇÿØ ÿ™ÿ™ŸÑŸÅ","D. ŸÑÿ£ŸÜŸáÿß ÿµÿ∫Ÿäÿ±ÿ© ÿßŸÑÿ≠ÿ¨ŸÖ"] },
    { type:"mcq", q:"ŸÑŸÖÿßÿ∞ÿß ÿ™ŸèŸÜŸáŸâ ÿßŸÑÿµŸàÿ± ÿ∫Ÿäÿ± ÿßŸÑŸÖÿ¨ÿ≥ŸÖÿ© ŸÑÿ∞Ÿàÿßÿ™ ÿßŸÑÿ£ÿ±Ÿàÿßÿ≠ÿü", a:"B", options:["A. ŸÑÿ£ŸÜŸáÿß ÿ∫Ÿäÿ± ÿ¨ŸÖŸäŸÑÿ©","B. ŸÑÿ£ŸÜŸáÿß ÿ™ÿØÿÆŸÑ ŸÅŸä ÿ®ÿßÿ® ÿßŸÑÿ™ÿ±ŸÅ ÿßŸÑÿ∞Ÿä ŸäŸèŸÅÿ≥ÿØ ÿßŸÑŸÇŸÑÿ®","C. ŸÑÿ£ŸÜŸáÿß ÿµÿπÿ®ÿ© ÿßŸÑÿµŸÜÿπ","D. ŸÑÿ£ŸÜŸáÿß ÿ™ÿ™ÿ∑ŸÑÿ® ŸÖŸáÿßÿ±ÿ© ÿπÿßŸÑŸäÿ©"] }
  ],
  "ÿµŸàÿ± ÿßŸÑÿ∑ÿ®Ÿäÿπÿ©": [
    { type:"tf", q:"ÿµŸàÿ± ÿßŸÑÿ¨ÿ®ÿßŸÑ ŸàÿßŸÑÿ®ÿ≠ÿßÿ± ŸàÿßŸÑÿ£ÿ¥ÿ¨ÿßÿ± ŸÑÿß ÿ≠ÿ±ÿ¨ ŸÅŸäŸáÿß.", a:true },
    { type:"mcq", q:"ŸÖÿ™Ÿâ ÿ™ŸèŸÖŸÜÿπ ÿµŸàÿ± ÿßŸÑÿ∑ÿ®Ÿäÿπÿ©ÿü", a:"B", options:["A. ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ŸÉÿ®Ÿäÿ±ÿ©","B. ÿ•ÿ∞ÿß ÿ£ÿØÿ™ ŸÑŸÖÿπÿµŸäÿ© ÿ£Ÿà ÿ™ÿ±ŸÅ ÿ≤ÿßÿ¶ÿØ","C. ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ŸÖÿ±ÿ≥ŸàŸÖÿ© ÿ®ÿØŸÇÿ©","D. ÿ•ÿ∞ÿß ŸàŸèÿ∂ÿπÿ™ ŸÅŸä ÿ∫ÿ±ŸÅÿ© ÿßŸÑÿ∂ŸäŸàŸÅ"] },
    { type:"mcq", q:"ŸÑŸÖÿßÿ∞ÿß ÿßŸÑÿ£ÿµŸÑ ÿ¨Ÿàÿßÿ≤ ÿµŸàÿ± ÿ∫Ÿäÿ± ÿ∞Ÿàÿßÿ™ ÿßŸÑÿ£ÿ±Ÿàÿßÿ≠ÿü", a:"B", options:["A. ŸÑÿ£ŸÜŸáÿß ÿ¨ŸÖŸäŸÑÿ©","B. ŸÑÿ£ŸÜŸáÿß ŸÑÿß ÿπŸÑÿßŸÇÿ© ŸÑŸáÿß ÿ®ÿßŸÑÿ™ÿπÿ∏ŸäŸÖ","C. ŸÑÿ£ŸÜŸáÿß ÿ±ÿÆŸäÿµÿ© ÿßŸÑÿ´ŸÖŸÜ","D. ŸÑÿ£ŸÜŸáÿß ÿ≥ŸáŸÑÿ© ÿßŸÑÿ∑ÿ®ÿßÿπÿ©"] }
  ],
  "ÿßŸÑÿµŸàÿ± ÿßŸÑŸÅŸàÿ™Ÿàÿ∫ÿ±ÿßŸÅŸäÿ©": [
    { type:"tf", q:"ÿßŸÑÿ£ÿµŸÑ ŸÅŸä ÿßŸÑÿµŸàÿ± ÿßŸÑŸÅŸàÿ™Ÿàÿ∫ÿ±ÿßŸÅŸäÿ© ÿßŸÑÿ•ÿ®ÿßÿ≠ÿ© ŸÖÿß ŸÑŸÖ ÿ™ÿ™ÿÆÿ∞ ŸÑÿ™ÿπÿ∏ŸäŸÖ ÿµÿßÿ≠ÿ®Ÿáÿß.", a:true },
    { type:"mcq", q:"ŸÖÿß ÿßŸÑÿ∞Ÿä Ÿäÿ¨ÿπŸÑ ÿßŸÑÿµŸàÿ±ÿ© ÿßŸÑŸÅŸàÿ™Ÿàÿ∫ÿ±ÿßŸÅŸäÿ© ŸÖÿ≠ÿ±ŸëŸÖÿ©ÿü", a:"B", options:["A. ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿ®ÿ¨ŸàÿØÿ© ÿπÿßŸÑŸäÿ©","B. ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿµÿßÿ≠ÿ®Ÿáÿß ŸÖŸÜ ÿßŸÑŸÅÿ≥ŸëÿßŸÇ ÿ£Ÿà ÿßŸÑŸÉŸÅÿßÿ± ŸàŸäŸèÿπÿ∏ŸëŸéŸÖ ÿ®Ÿáÿß","C. ÿ•ÿ∞ÿß ÿßŸÑÿ™ŸèŸÇÿ∑ÿ™ ŸÑÿ∞ŸÉÿ±Ÿâ","D. ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ŸÖŸÑŸàŸÜÿ©"] },
    { type:"mcq", q:"ŸÑŸÖÿßÿ∞ÿß ÿ™Ÿèÿ≠ÿ±ŸëŸÖ ÿßŸÑÿµŸàÿ± ÿßŸÑŸÅŸàÿ™Ÿàÿ∫ÿ±ÿßŸÅŸäÿ© ÿßŸÑŸÖÿπŸÑŸëŸÇÿ© ŸÑÿ£ŸáŸÑ ÿßŸÑŸÅÿ≥ÿßÿØÿü", a:"B", options:["A. ŸÑÿ£ŸÜŸáÿß ŸÉÿ®Ÿäÿ±ÿ© ÿßŸÑÿ≠ÿ¨ŸÖ","B. ŸÑÿ£ŸÜŸáÿß ŸÜŸàÿπ ŸÖŸÜ ÿßŸÑÿ™ÿπÿ∏ŸäŸÖ ŸÑÿ£ŸáŸÑ ÿßŸÑŸÉŸÅÿ± ŸàÿßŸÑŸÅÿ≥ÿßÿØ","C. ŸÑÿ£ŸÜŸáÿß ÿ®ÿßŸáÿ∂ÿ© ÿßŸÑÿ´ŸÖŸÜ","D. ŸÑÿ£ŸÜŸáÿß ÿ∫Ÿäÿ± Ÿàÿßÿ∂ÿ≠ÿ©"] }
  ],
  "ÿ£ÿ≠ŸÉÿßŸÖ ÿßŸÇÿ™ŸÜÿßÿ° ÿßŸÑŸÉŸÑÿßÿ®": [
    { type:"tf", q:"ŸÜŸáŸâ ÿßŸÑŸÜÿ®Ÿä Ô∑∫ ÿπŸÜ ÿßŸÇÿ™ŸÜÿßÿ° ÿßŸÑŸÉŸÑÿßÿ® ŸÑÿ∫Ÿäÿ± ÿ≠ÿßÿ¨ÿ©.", a:true },
    { type:"mcq", q:"ŸÖÿß ÿßŸÑÿ≠ŸÉŸÖÿ© ŸÖŸÜ ÿßŸÑŸÜŸáŸä ÿπŸÜ ÿ•ÿØÿÆÿßŸÑ ÿßŸÑŸÉŸÑÿßÿ® ŸÅŸä ÿßŸÑÿ®ŸäŸàÿ™ÿü", a:"B", options:["A. ŸÑÿ£ŸÜŸáÿß ÿ™ŸèÿµÿØÿ± ÿ±Ÿàÿßÿ¶ÿ≠","B. ŸÑÿ£ŸÜŸáÿß ÿ™ŸÜÿ®ÿ≠ Ÿàÿ™ÿ≤ÿπÿ¨ ÿßŸÑÿ∂ŸäŸàŸÅ Ÿàÿ™ÿ±Ÿàÿπ ÿßŸÑŸÜÿßÿ≥","C. ŸÑÿ£ŸÜŸáÿß ŸÖŸÉÿ±ŸàŸáÿ© ÿπŸÜÿØ ÿßŸÑÿπÿ±ÿ®","D. ŸÑÿ£ŸÜŸáÿß ÿ™ÿ≠ÿ™ÿßÿ¨ ÿ∑ÿπÿßŸÖŸãÿß ŸÉÿ´Ÿäÿ±Ÿãÿß"] },
    { type:"mcq", q:"ŸÖÿß ÿ£ÿÆÿ∑ÿ± ÿ≥ÿ®ÿ® ÿπŸÑŸÖŸä ŸÖÿ∞ŸÉŸàÿ± ŸÅŸä ÿ™ÿ≠ÿ±ŸäŸÖ ÿßŸÇÿ™ŸÜÿßÿ° ÿßŸÑŸÉŸÑÿßÿ®ÿü", a:"B", options:["A. ÿ£ŸÜŸáÿß ÿ™ÿµŸäÿ® ÿßŸÑÿ•ŸÜÿ≥ÿßŸÜ ÿ®ÿßŸÑÿ≠ÿ≥ÿßÿ≥Ÿäÿ©","B. ÿ£ŸÜŸáÿß ÿ™ŸÜŸÇŸÑ ÿØŸäÿØÿßŸÜŸãÿß ÿÆÿ∑Ÿäÿ±ÿ© ÿπÿ®ÿ± ÿßŸÑŸÑÿπŸÇ ŸàÿßŸÑŸàŸÑŸàÿ∫","C. ÿ£ŸÜŸáÿß ÿ™ŸÜÿßŸÖ ŸÅŸä ŸÉŸÑ ŸÖŸÉÿßŸÜ","D. ÿ£ŸÜŸáÿß ÿ™ÿ≥ÿ®ÿ® ÿßŸÑÿ∂ÿ¨Ÿäÿ¨"] }
  ]
};

/* ========== RESET GAME ON PAGE LOAD ========== */
db.ref("game").remove().then(() => {
  gameState = {
    team: null,
    currentSection: null,
    currentQuestionIndex: 0,
    currentQuestions: [],
    lockedSections: {},
    timeUp: false
  };
  showScreen("teamScreen");
});

/* ========== TEAM JOIN ========== */
function joinTeam(team) {
  gameState.team = team;

  db.ref("game/redScore").once("value").then(snap => { if(snap.val() === null) db.ref("game/redScore").set(0); });
  db.ref("game/blueScore").once("value").then(snap => { if(snap.val() === null) db.ref("game/blueScore").set(0); });

  db.ref("game/teams/"+team).set({ joined: true, count: firebase.database.ServerValue.increment(1) });

  document.getElementById("redBtn").disabled = true;
  document.getElementById("blueBtn").disabled = true;
  document.getElementById("waitingMsg").style.display = "block";
}

/* ========== LISTEN TEAMS ========== */
db.ref("game/teams").on("value", snap => {
  const data = snap.val() || {};
  const redJoined = data.red?.joined || false;
  const blueJoined = data.blue?.joined || false;

  document.getElementById("teamStatus").innerHTML = `Red: ${redJoined?"‚úîÔ∏è":"‚ùå"} | Blue: ${blueJoined?"‚úîÔ∏è":"‚ùå"}`;

  if(redJoined && blueJoined && gameState.team && !gameState.timeUp && !document.getElementById("sectionScreen").classList.contains("active")) {
    showScreen("sectionScreen");
    document.getElementById("liveScore").style.display = "block";
    loadSections();
    startTimer();
  }
});

/* ========== LISTEN SCORES ========== */
db.ref("game/redScore").on("value", snap => {
  const score = snap.val() || 0;
  document.getElementById("redScoreLive").textContent = score;
});
db.ref("game/blueScore").on("value", snap => {
  const score = snap.val() || 0;
  document.getElementById("blueScoreLive").textContent = score;
});

/* ========== SECTIONS ========== */
db.ref("game/lockedSections").on("value", snap => {
  gameState.lockedSections = snap.val() || {};
  if(document.getElementById("sectionScreen").classList.contains("active")) loadSections();

  const totalSections = Object.keys(sections).length;
  const takenSections = Object.keys(gameState.lockedSections).length;

  if(takenSections === totalSections || gameState.timeUp) showScore();
});

function loadSections() {
  const container = document.getElementById("sections");
  container.innerHTML = "";

  document.getElementById("sectionTitle").innerHTML = `${gameState.team === "red" ? "Red Team üî¥" : "Blue Team üîµ"} - Pick a Section`;

  Object.keys(sections).forEach(sec => {
    const div = document.createElement("div");
    div.className = "section";

    const takenBy = gameState.lockedSections[sec];

    if(takenBy) {
      div.innerHTML = sec + ` ${takenBy === "red" ? "üî¥" : takenBy === "blue" ? "üîµ" : "‚è∞"} (Taken)`;
      div.classList.add("locked");
      div.onclick = null;
    } else {
      div.innerHTML = sec;
      div.onclick = () => pickSection(sec);
    }

    container.appendChild(div);
  });
}

function pickSection(sec) {
  if(gameState.lockedSections[sec] || gameState.timeUp) return;

  db.ref("game/lockedSections/"+sec).set(gameState.team);
  gameState.currentSection = sec;
  gameState.currentQuestions = sections[sec];
  gameState.currentQuestionIndex = 0;

  showQuestion(gameState.currentQuestions[0]);
}

/* ========== QUESTIONS ========== */
function showQuestion(q) {
  showScreen("questionScreen");
  const qNum = gameState.currentQuestionIndex + 1;
  const qType = q.type === "tf" ? "True/False" : q.type === "mcq" ? "Multiple Choice" : "Hadith";

  let html = `<h3>${gameState.team === "red" ? "Red Team üî¥" : "Blue Team üîµ"}</h3>
              <p style="color:#666; font-size:14px;">${gameState.currentSection} - ${qType} (${qNum}/${gameState.currentQuestions.length})</p>
              <p style="font-size:20px; margin:20px 0;">${q.q}</p>`;

  if(q.type === "tf") {
    html += `<button onclick="answer(true)">‚úîÔ∏è True</button>
             <button onclick="answer(false)">‚ùå False</button>`;
  } else if(q.type === "mcq" || q.type === "hadith") {
    q.options.forEach((opt, i) => {
      const letter = String.fromCharCode(65 + i); // 'A', 'B', 'C', 'D'
      html += `<button onclick="answer('${letter}')">${opt}</button>`;
    });
  }

  document.getElementById("questionBox").innerHTML = html;
}

function answer(selected) {
  if(gameState.timeUp) return;

  const q = gameState.currentQuestions[gameState.currentQuestionIndex];
  if(!q) return;

  let isCorrect = false;
  if(typeof q.a === "boolean") isCorrect = (selected === q.a);
  else isCorrect = (selected.toString().trim().toUpperCase() === q.a.toString().trim().toUpperCase());

  if(isCorrect) db.ref(`game/${gameState.team}Score`).transaction(s => (s||0)+1);

  gameState.currentQuestionIndex++;
  if(gameState.currentQuestionIndex < gameState.currentQuestions.length) showQuestion(gameState.currentQuestions[gameState.currentQuestionIndex]);
  else showScreen("sectionScreen");
}

/* ========== TIMER ========== */
let timerInterval;
function startTimer() {
  if(timerInterval) return;

  let timeLeft = 30*60;
  updateTimerDisplay(timeLeft);

  timerInterval = setInterval(() => {
    timeLeft--;
    updateTimerDisplay(timeLeft);

    if(timeLeft <= 0) {
      clearInterval(timerInterval);
      timerInterval = null;
      gameState.timeUp = true;

      Object.keys(sections).forEach(sec => {
        if(!gameState.lockedSections[sec]) db.ref("game/lockedSections/"+sec).set("timeUp");
      });

      showScore();
    }
  }, 1000);
}

function updateTimerDisplay(seconds) {
  const min = Math.floor(seconds/60).toString().padStart(2,'0');
  const sec = (seconds%60).toString().padStart(2,'0');
  document.getElementById("timer").textContent = `‚è±Ô∏è ${min}:${sec}`;
}

/* ========== SCORE SCREEN ========== */
function showScore() {
  showScreen("scoreScreen");

  db.ref("game").once("value").then(snap => {
    const d = snap.val() || {};
    const redScore = d.redScore || 0;
    const blueScore = d.blueScore || 0;
    const lockedSections = d.lockedSections || {};

    let winner = "Tie ü§ù";
    if(redScore > blueScore) winner = "Red Team üî¥";
    else if(blueScore > redScore) winner = "Blue Team üîµ";

    let redSections="", blueSections="";
    Object.keys(sections).forEach(sec => {
      const takenBy = lockedSections[sec];
      if(takenBy === "red") redSections += `‚úîÔ∏è ${sec}<br>`;
      else if(takenBy === "blue") blueSections += `‚úîÔ∏è ${sec}<br>`;
      else if(takenBy === "timeUp") {
        redSections += `‚è∞ ${sec} (Not Finished)<br>`;
        blueSections += `‚è∞ ${sec} (Not Finished)<br>`;
      }
    });

    document.getElementById("scoreText").innerHTML = `
      <div style="font-size:20px; margin:15px 0;">
        <b>üî¥ Red Team:</b> ${redScore} points<br>Completed Sections:<br>${redSections}<br>
        <b>üîµ Blue Team:</b> ${blueScore} points<br>Completed Sections:<br>${blueSections}<br>
      </div>
      <div style="font-size:24px; margin:20px 0; color:#4caf50;">Winner: ${winner}</div>
    `;
  });
}

/* ========== RESET GAME ========== */
function resetGame() {
  clearInterval(timerInterval);
  timerInterval = null;

  db.ref("game").remove().then(() => {
    gameState = {
      team: null,
      currentSection: null,
      currentQuestionIndex: 0,
      currentQuestions: [],
      lockedSections: {},
      timeUp: false
    };
    showScreen("teamScreen");
    document.getElementById("liveScore").style.display = "none";
  });
}

/* ========== SCREEN SWITCH ========== */
function showScreen(id) {
  document.querySelectorAll(".screen").forEach(s => s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}
</script>
</body>
</html>
