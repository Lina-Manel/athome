<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Islamic Red vs Blue Game (Session)</title>
<style>
  body { font-family: Arial; background:#f5f5f5; text-align:center; }
  h1 { margin-top:20px; }
  .screen { display:none; padding:20px; }
  .active { display:block; }
  .team-btn { padding:20px 40px; margin:20px; font-size:22px; border:none; color:white; border-radius:15px; cursor:pointer; }
  .red { background:#c62828; }
  .blue { background:#1565c0; }
  .section { background:white; padding:15px; margin:10px auto; width:80%; max-width:400px; border-radius:12px; cursor:pointer; box-shadow:0 2px 4px rgba(0,0,0,0.1);}
  .locked { background:#ddd; cursor:not-allowed; }
  #questionBox { background:white; padding:20px; width:85%; max-width:500px; margin:20px auto; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.2);}
  button { padding:12px 20px; margin-top:20px; font-size:18px; cursor:pointer;}
</style>
</head>
<body>

<h1>Red vs Blue Islamic Game</h1>

<!-- TEAM SELECTION -->
<div id="teamScreen" class="screen active">
  <h2>Choose your team</h2>
  <p id="teamStatus">Waiting for both teams to join...</p>
  <button class="team-btn red" onclick="joinTeam('red')">Red Team üî¥</button>
  <button class="team-btn blue" onclick="joinTeam('blue')">Blue Team üîµ</button>
</div>

<!-- WAIT FOR START -->
<div id="waitScreen" class="screen">
  <h2>Waiting for the other team to join...</h2>
  <p id="waitText"></p>
  <button id="startBtn" onclick="startGame()" style="display:none;">Start Game</button>
</div>

<!-- SECTIONS SCREEN -->
<div id="sectionScreen" class="screen">
  <h2>Pick a Section</h2>
  <div id="sections"></div>
</div>

<!-- QUESTION SCREEN -->
<div id="questionScreen" class="screen">
  <div id="questionBox"></div>
</div>

<!-- SCORE SCREEN -->
<div id="scoreScreen" class="screen">
  <h2>Final Score</h2>
  <p id="scoreText"></p>
  <button onclick="resetGame()">Restart</button>
</div>

<script>
// ==== Game State ====
let gameState = {
  sessionId: null,
  redJoined: false,
  blueJoined: false,
  redScore:0,
  blueScore:0,
  lockedSections:{},
  currentTeam:null,
  totalSections:0,
  usedSections:0,
  team:null // current device team
};

// ==== Sections and Questions ====
const sections = {
  "ÿßŸÑŸÜÿ∏ÿßŸÅÿ© ŸÅŸä ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖ":["ŸÑŸÖÿßÿ∞ÿß Ÿäÿπÿ™ÿ®ÿ± ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖ ÿßŸÑŸÜÿ∏ÿßŸÅÿ© ÿ¨ÿ≤ÿ°Ÿãÿß ŸÖŸÜ ÿßŸÑÿ•ŸäŸÖÿßŸÜÿü","ÿßÿ∞ŸÉÿ± ŸÖÿ´ÿßŸÑŸãÿß ŸÖŸÜ ÿßŸÑÿ≥ŸÜÿ© ŸäÿØŸÑ ÿπŸÑŸâ ÿ£ŸáŸÖŸäÿ© ÿßŸÑŸÜÿ∏ÿßŸÅÿ©."],
  "ÿßŸÑÿ™ÿ±ŸÅ ŸàÿßŸÑŸÖÿ∏ÿßŸáÿ± ÿßŸÑŸàÿ´ŸÜŸäÿ©":["ŸÖÿß ŸáŸà ŸÖŸàŸÇŸÅ ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖ ŸÖŸÜ ÿßŸÑŸÖÿ®ÿßŸÑÿ∫ÿ© ŸÅŸä ÿßŸÑÿ≤ŸäŸÜÿ©ÿü","ŸÑŸÖÿßÿ∞ÿß Ÿäÿ≠ÿ∞ÿ± ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖ ŸÖŸÜ ÿßŸÑÿ™ÿ¥ÿ®Ÿá ÿ®ÿßŸÑŸàÿ´ŸÜŸäŸäŸÜÿü"],
  "ÿ¢ŸÜŸäÿ© ÿßŸÑÿ∞Ÿáÿ® ŸàÿßŸÑŸÅÿ∂ÿ©":["ŸÖÿß ÿ≠ŸÉŸÖ ÿßŸÑÿ£ŸÉŸÑ ÿ£Ÿà ÿßŸÑÿ¥ÿ±ÿ® ŸÅŸä ÿ£ŸàÿßŸÜŸä ÿßŸÑÿ∞Ÿáÿ® ŸàÿßŸÑŸÅÿ∂ÿ©ÿü","ÿßÿ∞ŸÉÿ± ÿ≥ÿ®ÿ®Ÿãÿß ŸÖŸÜ ÿ£ÿ≥ÿ®ÿßÿ® ÿßŸÑÿ™ÿ≠ÿ±ŸäŸÖ."],
  "ÿ™ÿ¥ÿÆŸäÿµ Ÿàÿ™ŸÖÿßÿ´ŸäŸÑ":["ŸÖÿß ÿ≠ŸÉŸÖ ÿßŸÑÿ™ŸÖÿßÿ´ŸäŸÑ ÿßŸÑŸÖÿ¨ÿ≥ŸÖÿ© ŸÅŸä ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖÿü","ŸáŸÑ Ÿäÿ¨Ÿàÿ≤ Ÿàÿ∂ÿπ ÿßŸÑÿ™ŸÖÿßÿ´ŸäŸÑ ŸÑŸÑÿ≤ŸäŸÜÿ© ŸÅŸÇÿ∑ÿü ŸàŸÑŸÖÿßÿ∞ÿßÿü"],
  "ÿµŸàÿ± Ÿàÿ±ÿ≥ŸàŸÖÿßÿ™":["ŸÖÿß ÿßŸÑŸÅÿ±ŸÇ ÿ®ŸäŸÜ ÿßŸÑÿµŸàÿ± ÿßŸÑŸÅŸàÿ™Ÿàÿ∫ÿ±ÿßŸÅŸäÿ© ŸàÿßŸÑŸÖÿ±ÿ≥ŸàŸÖÿ©ÿü","ŸáŸÑ Ÿäÿ¨Ÿàÿ≤ ÿ™ÿπŸÑŸäŸÇ ÿßŸÑÿµŸàÿ± ÿπŸÑŸâ ÿßŸÑÿ¨ÿØÿ±ÿßŸÜÿü"],
  "ÿßŸÇÿ™ŸÜÿßÿ° ÿßŸÑŸÉŸÑÿßÿ®":["ŸÖÿß ÿ≠ŸÉŸÖ ÿßŸÇÿ™ŸÜÿßÿ° ÿßŸÑŸÉŸÑÿßÿ® ÿ®ÿØŸàŸÜ ÿ≠ÿßÿ¨ÿ©ÿü","ÿßÿ∞ŸÉÿ± ÿßŸÑÿ≠ÿßŸÑÿßÿ™ ÿßŸÑÿ™Ÿä Ÿäÿ¨Ÿàÿ≤ ŸÅŸäŸáÿß ÿßŸÇÿ™ŸÜÿßÿ° ÿßŸÑŸÉŸÑÿßÿ®."]
};
gameState.totalSections = Object.keys(sections).length;

// ==== Session Handling ====
function getSessionId() {
  const params = new URLSearchParams(window.location.search);
  if(params.has('session')) return params.get('session');
  const id = Date.now().toString(); // generate session
  window.history.replaceState({}, '', `?session=${id}`);
  return id;
}

gameState.sessionId = getSessionId();

// ==== Team Joining ====
function joinTeam(team){
  gameState.team = team;
  if(team==='red') gameState.redJoined=true;
  else gameState.blueJoined=true;

  // show wait screen
  showScreen('waitScreen');
  updateWaitText();
}

// ==== Wait Text Update ====
function updateWaitText(){
  const waitText = document.getElementById('waitText');
  let text=`Red Team: ${gameState.redJoined?'‚úîÔ∏è':'‚ùå'} | Blue Team: ${gameState.blueJoined?'‚úîÔ∏è':'‚ùå'}`;
  waitText.innerHTML=text;

  // show start button only for red team (host)
  if(gameState.redJoined && gameState.blueJoined && gameState.team==='red'){
    document.getElementById('startBtn').style.display='inline-block';
  }
}

// ==== Start Game ====
function startGame(){
  gameState.currentTeam='red';
  showScreen('sectionScreen');
  loadSections();
}

// ==== Load Sections ====
function loadSections(){
  const container=document.getElementById('sections');
  container.innerHTML='';
  Object.keys(sections).forEach(sec=>{
    const div=document.createElement('div');
    div.className='section';
    if(gameState.lockedSections[sec]) div.classList.add('locked'), div.innerHTML=`${sec} ‚ùå (Taken by ${gameState.lockedSections[sec]})`;
    else {div.innerHTML=sec; div.onclick=()=>pickSection(sec);}
    container.appendChild(div);
  });
}

// ==== Pick Section ====
function pickSection(section){
  if(gameState.lockedSections[section]) return;
  gameState.lockedSections[section]=gameState.currentTeam;
  gameState.usedSections++;
  const qList=sections[section];
  const q=qList[Math.floor(Math.random()*qList.length)];
  showQuestion(q);
}

// ==== Show Question ====
function showQuestion(q){
  showScreen('questionScreen');
  const box=document.getElementById('questionBox');
  box.innerHTML=`
    <h3>Question for ${gameState.currentTeam==='red'?'Red Team üî¥':'Blue Team üîµ'}</h3>
    <p>${q}</p>
    <button onclick="answer(true)">Correct ‚úîÔ∏è</button>
    <button onclick="answer(false)">Wrong ‚ùå</button>
  `;
}

// ==== Answer Handling ====
function answer(isCorrect){
  if(isCorrect){
    if(gameState.currentTeam==='red') gameState.redScore++;
    else gameState.blueScore++;
  }
  gameState.currentTeam=gameState.currentTeam==='red'?'blue':'red';

  if(gameState.usedSections===gameState.totalSections){
    showScore();
  }else{
    showScreen('sectionScreen');
    loadSections();
  }
}

// ==== Show Score ====
function showScore(){
  showScreen('scoreScreen');
  const s=document.getElementById('scoreText');
  s.innerHTML=`
    üî¥ Red Team: ${gameState.redScore}<br>
    üîµ Blue Team: ${gameState.blueScore}<br><br>
    <strong>Winner: ${gameState.redScore>gameState.blueScore?'Red Team üî¥':gameState.redScore<gameState.blueScore?'Blue Team üîµ':'Tie ü§ù'}</strong>
  `;
}

// ==== Reset ====
function resetGame(){
  window.location.href=window.location.pathname+'?session='+gameState.sessionId;
}

// ==== Show Screen ====
function showScreen(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}
</script>
</body>
</html>
